<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Your first notarization | Notarization of documents on NEM blockchain</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Your first notarization" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Alice has a document on her computer. She wants to prove the document existed on a specific date and that she has access to it. This document could be any digital file with an interest to be notarized. For example, a meaningful contract, a movie script or a patent." />
<meta property="og:description" content="Alice has a document on her computer. She wants to prove the document existed on a specific date and that she has access to it. This document could be any digital file with an interest to be notarized. For example, a meaningful contract, a movie script or a patent." />
<link rel="canonical" href="http://localhost:4000/en/lessons/first-notarization/" />
<meta property="og:url" content="http://localhost:4000/en/lessons/first-notarization/" />
<meta property="og:site_name" content="Notarization of documents on NEM blockchain" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-03-11T15:24:30+08:00" />
<script type="application/ld+json">
{"headline":"Your first notarization","dateModified":"2019-03-11T15:24:30+08:00","description":"Alice has a document on her computer. She wants to prove the document existed on a specific date and that she has access to it. This document could be any digital file with an interest to be notarized. For example, a meaningful contract, a movie script or a patent.","datePublished":"2019-03-11T15:24:30+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/en/lessons/first-notarization/"},"@type":"BlogPosting","url":"http://localhost:4000/en/lessons/first-notarization/","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/en/assets/main.css">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/en/feed.xml" title="Notarization of documents on NEM blockchain" /></head>
<body><header class="site-header" role="banner">

    <div class="wrapper"><a class="site-title" rel="author" href="/en/"><span><img src="/en/assets/logo-nem.svg"/></span> workshop.cn</a><nav class="site-nav">
            <input type="checkbox" id="nav-trigger" class="nav-trigger" />
            <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
            </label>

            <div class="trigger">
                <div class="changeLanguage">
                <select onchange="changeLanguage('/lessons/first-notarization/')" id="languageType">
                  <option value ="language" disabled selected>Language</option>
                  <option value ="en">English</option>
                  <option value ="ch">中文</option>
                </select>
              </div>
                <i class="fab fa-github"></i> <a class="page-link" href="/edit/master/_lessons/04-first-notarization.markdown"> Edit on GitHub</a>
            </div>
        </nav></div>
</header><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="row">

    <div class="sidebar-wrapper col-3">
        <ol><li>
                <a href="/en/lessons/introduction/">
                    Introduction
                </a>
            </li><li>
                <a href="/en/lessons/public-and-private-blockchain/">
                    Public and private blockchains
                </a>
            </li><li>
                <a href="/en/lessons/prepare-your-workstation/">
                    Prepare your workstation
                </a>
            </li><li>
                <a href="/en/lessons/first-notarization/">
                    Your first notarization
                </a>
            </li><li>
                <a href="/en/lessons/content-and-ownership-verification/">
                    Content and ownership verification
                </a>
            </li><li>
                <a href="/en/lessons/confidential-notarization/">
                    Confidential notarization
                </a>
            </li><li>
                <a href="/en/lessons/recipient/">
                    Choosing the transaction recipient
                </a>
            </li><li>
                <a href="/en/lessons/notarization-updates/">
                    Enabling notarization updates
                </a>
            </li><li>
                <a href="/en/lessons/co-signed-notarization/">
                    Co-signed notarization
                </a>
            </li><li>
                <a href="/en/lessons/transfer-notarization/">
                    Transfer notarization
                </a>
            </li><li>
                <a href="/en/lessons/delegated-notarization/">
                    Delegated notarization
                </a>
            </li><li>
                <a href="/en/lessons/future-work/">
                    Future Work: Apostille library
                </a>
            </li></ol>

    </div>

    <div class="col-9">
        <article class="lesson h-entry" itemscope itemtype="http://schema.org/BlogPosting">

            <header class="lesson-header">
                <h1 class="lesson-title p-name" itemprop="name headline">Your first notarization</h1>
            </header>

            <div class="lesson-content e-content" itemprop="articleBody">
                <p>Alice has a document on her computer. She wants to prove the document existed on a specific date and that she has access to it. This document could be any digital file with an interest to be notarized.  For example, a meaningful contract, a movie script or a patent.</p>

<p>In this first exercise, you will be saving the whole content of the file inside the blockchain. Normally, it is not a good idea to store large amounts of data in the blockchain. This first approach will allow us to upgrade the solution in the following exercises.</p>

<h2 id="background">Background</h2>

<p>NEM is <a href="https://nemtech.github.io/concepts/account.html">account</a> based and  <a href="https://nemtech.github.io/concepts/transaction.html">transaction</a> driven. An account allows:</p>

<ul>
  <li>To hold assets.</li>
  <li>To be uniquely identified.</li>
  <li>To alter the status of the blockchain, by announcing transactions with <a href="https://nemtech.github.io/concepts/mosaic.html">assets</a> and messages to other accounts.</li>
</ul>

<p>An account consist of three main components:</p>

<ul>
  <li><strong>Private key</strong>: A string that holds all the power of the account.</li>
  <li><strong>Public key</strong>: The public key is derived from the private key and identifies your account in the network. It is secure to share your public key with anyone.</li>
  <li><strong>Address</strong>:  The address is then derived from your public key. You will normally share the derived address instead, as it is shorter and gathers more information.</li>
</ul>

<p><img src="/en/assets/images/diagram-notarization.png" alt="diagram-notarization" /></p>

<h2 id="solution">Solution</h2>

<p>We will create two accounts.</p>

<ul>
  <li>A: Alice’s account.</li>
  <li>B: A wallet Alice uses to store her notarizations.</li>
</ul>

<p>Then, A will announce a transaction to B, adding the content of the file to be notarized as a message.</p>

<p>The transaction, if valid, will be <a href="https://nemtech.github.io/concepts/block.html">included in a block</a>. When new blocks are added on top, you can assume the transaction will persist in the blockchain.</p>

<p>Performing actions in the blockchain have a cost. This is necessary to provide an incentive for those who validate and secure the network. The fee is paid in XEM, the underlying cryptocurrency of the NEM network.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ℹ️ In a private network, you could set transaction fees to 0.
</code></pre></div></div>

<p>Instead of creating a new account, let’s use an account which already has XEM.</p>

<p>1. Open a terminal and go to the directory where you have downloaded Catapult Bootstrap Service.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$&gt;</span> <span class="nb">cd  </span>build/generated-addresses/
<span class="nv">$&gt;</span> <span class="nb">cat </span>addresses.yaml</code></pre></figure>

<p>Under the section nemesis_addresses, you will find the key pairs which contain XEM.</p>

<p>Load the first account as a profile in NEM2-CLI. This account identifies Alice.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$&gt;</span> nem2-cli profile create
Introduce network <span class="nb">type</span> <span class="o">(</span>MIJIN_TEST, MIJIN, MAIN_NET, TEST_NET<span class="o">)</span>: MIJIN_TEST
Introduce NEM 2 Node URL. <span class="o">(</span>Example: http://localhost:3000<span class="o">)</span>: http://localhost:3000
Insert profile name <span class="o">(</span>blank means default and it could overwrite the previous profile<span class="o">)</span>: alice
New Account:    SBFSSN-MF5DOC-Q7S62D-ALYPXT-6KZM44-RT367B-VWSE
Public Key:     3F2842ABC234D068B06625D01224D9E62D9767C79E4DF7BB5F562869DC6539FD
Private Key:    6D...80</code></pre></figure>

<p>Create a new profile for Alice’s notarizations.</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$&gt;</span> nem2-cli account generate
Introduce network <span class="nb">type</span> <span class="o">(</span>MIJIN_TEST, MIJIN, MAIN_NET, TEST_NET<span class="o">)</span>: MIJIN_TEST
Do you want to save it? <span class="o">[</span>y/n]: y
Introduce NEM 2 Node URL. <span class="o">(</span>Example: http://localhost:3000<span class="o">)</span>: http://localhost:3000
Insert profile name <span class="o">(</span>blank means default and it could overwrite the previous profile<span class="o">)</span>: alice_notarizations_wallet
New Account:    SC5ZOIOYKHKEIJOXEFJQK5KRRE5KNZFDZTZA43BI
Public Key:     EBEC67B604C1C549674B4B021228A0DE8975A29071E496FCCE4446DEBA15F20B
Private Key:    41...F6</code></pre></figure>

<p>You can fetch the account’s information anytime by running:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$&gt;</span> nem2-cli profile list</code></pre></figure>

<p>2. Create a new .txt file, and write “Hello World” inside. NEM messages length is limited to <code class="highlighter-rouge">1024</code> characters.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>You could split the content into several transfer transactions, but it is preferable not to store a large amount of data in the blockchain. In the next exercise, you will see how to solve this issue.
</code></pre></div></div>

<p>3. Open the <a href="http://localhost:4200/">Notarization dashboard</a> in your browser. You should see the following screen:</p>

<p><img src="/en/assets/images/screenshot-notarization-panel.png" alt="screenshot-notarization-panel" /></p>

<p>Have you tried to do a notarization using the panel? It is still not working. You will have to code the NEM integration.</p>

<p>4. Review <code class="highlighter-rouge">notarize()</code> function under <code class="highlighter-rouge">project/src/app/components/createNotarization.component.ts</code>.</p>

<p>You will see the notarization transaction is created, then signed by an account and finally announced to the network.</p>

<figure class="highlight"><pre><code class="language-typescript" data-lang="typescript">  <span class="nx">notarize</span><span class="p">(</span><span class="nx">form</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">account</span> <span class="o">=</span> <span class="nx">Account</span><span class="p">.</span><span class="nx">createFromPrivateKey</span><span class="p">(</span><span class="nx">form</span><span class="p">.</span><span class="nx">privateKey</span><span class="p">,</span> <span class="nx">NetworkType</span><span class="p">.</span><span class="nx">MIJIN_TEST</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">recipient</span> <span class="o">=</span> <span class="nx">Address</span><span class="p">.</span><span class="nx">createFromRawAddress</span><span class="p">(</span><span class="nx">form</span><span class="p">.</span><span class="nx">address</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">message</span> <span class="o">=</span> <span class="nx">PlainMessage</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">form</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">notarization</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">notarizationService</span><span class="p">.</span><span class="nx">createNotarizationTransaction</span><span class="p">(</span><span class="nx">recipient</span><span class="p">,</span> <span class="nx">message</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">signedNotarization</span> <span class="o">=</span> <span class="nx">account</span><span class="p">.</span><span class="nx">sign</span><span class="p">(</span><span class="nx">notarization</span><span class="o">!</span><span class="p">);</span>

    <span class="p">[..]</span>
    
    <span class="k">this</span><span class="p">.</span><span class="nx">transactionHttp</span>
      <span class="p">.</span><span class="nx">announce</span><span class="p">(</span><span class="nx">signedNotarization</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">announcedTransaction</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">announcedTransaction</span><span class="p">),</span>
       <span class="nx">err</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
  <span class="p">}</span></code></pre></figure>

<p>Once an account announces a transaction, the server will always return an OK response.</p>

<p>Transactions get the <code class="highlighter-rouge">unconfirmed status</code> status as soon they reach the network. It is only when a transaction is included in one block that it receives the confirmation.</p>

<p>Receiving an OK response does not mean the transaction is valid. A good practice is to monitor transactions status before being announced.</p>

<figure class="highlight"><pre><code class="language-typescript" data-lang="typescript">  
    <span class="k">this</span><span class="p">.</span><span class="nx">listener</span><span class="p">.</span><span class="nx">open</span><span class="p">().</span><span class="nx">then</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">listener</span>
        <span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="nx">account</span><span class="p">.</span><span class="nx">address</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
          <span class="nx">filter</span><span class="p">((</span><span class="nx">transaction</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">transaction</span><span class="p">.</span><span class="nx">hash</span> <span class="o">===</span> <span class="nx">signedNotarization</span><span class="p">.</span><span class="nx">hash</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">errorStatus</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">progress</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="nx">errorStatus</span><span class="p">.</span><span class="nx">status</span><span class="p">,</span> <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'ERROR'</span><span class="p">};</span>
        <span class="p">},</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">progress</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="nx">err</span><span class="p">,</span> <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'ERROR'</span><span class="p">});</span>

      <span class="k">this</span><span class="p">.</span><span class="nx">listener</span>
        <span class="p">.</span><span class="nx">confirmed</span><span class="p">(</span><span class="nx">account</span><span class="p">.</span><span class="nx">address</span><span class="p">)</span>
        <span class="p">.</span><span class="nx">pipe</span><span class="p">(</span>
          <span class="nx">filter</span><span class="p">((</span><span class="nx">transaction</span><span class="p">)</span> <span class="o">=&gt;</span>
            <span class="nx">transaction</span><span class="p">.</span><span class="nx">transactionInfo</span> <span class="o">!==</span> <span class="kc">undefined</span>
            <span class="o">&amp;&amp;</span> <span class="nx">transaction</span><span class="p">.</span><span class="nx">transactionInfo</span><span class="p">.</span><span class="nx">hash</span> <span class="o">===</span> <span class="nx">signedNotarization</span><span class="p">.</span><span class="nx">hash</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">ignored</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">progress</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="s1">'Notarization confirmed with hash '</span> <span class="o">+</span> <span class="nx">signedNotarization</span><span class="p">.</span><span class="nx">hash</span><span class="p">,</span> <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'CONFIRMED'</span><span class="p">};</span>
        <span class="p">},</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">progress</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'message'</span><span class="p">:</span> <span class="nx">err</span><span class="p">,</span> <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'ERROR'</span><span class="p">});</span>
        
        <span class="p">[...]</span>
    <span class="p">});</span>
  <span class="p">}</span>
    </code></pre></figure>

<p>5. Open <code class="highlighter-rouge">project/src/app/services/notarization.service.ts</code> and create a transfer transaction under <code class="highlighter-rouge">createNotarizationTransaction</code>function. A transaction requires:</p>

<ul>
  <li><strong>Deadline</strong>: How many blocks can pass before the transaction has to be included in a block.</li>
  <li><strong>Recipient</strong>: The account’s address where Alice will send the notarization.</li>
  <li><strong>Message</strong>: The content of the file as a message.</li>
  <li><strong>Network</strong>: In this exercise we are using MIJIN_TESTNET.</li>
</ul>

<figure class="highlight"><pre><code class="language-typescript" data-lang="typescript">  <span class="nx">createNotarizationTransaction</span><span class="p">(</span><span class="nx">recipient</span><span class="p">:</span> <span class="nx">Address</span><span class="p">,</span> <span class="nx">message</span><span class="p">:</span> <span class="nx">PlainMessage</span><span class="p">)</span> <span class="p">:</span> <span class="nx">TransferTransaction</span><span class="p">{</span>

    <span class="k">return</span> <span class="nx">TransferTransaction</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span>
      <span class="nx">Deadline</span><span class="p">.</span><span class="nx">create</span><span class="p">(),</span>
      <span class="nx">recipient</span><span class="p">,</span>
      <span class="p">[],</span>
      <span class="nx">message</span><span class="p">,</span>
      <span class="nx">NetworkType</span><span class="p">.</span><span class="nx">MIJIN_TEST</span>
    <span class="p">);</span>
  <span class="p">}</span></code></pre></figure>

<p>6. Save your changes and go back to the notarization panel. Drag and drop your .txt file, paste Alice’s notarization wallet address (B) and Alice’s private key (A) to sign the transaction. Then, click <code class="highlighter-rouge">Notarize</code> to announce the notarization to the network.</p>

<p><img src="/en/assets/images/screenshot-public-notarization.png" alt="screenshot-public-notarization" /></p>

<p>7. Wait until the status message states <strong>“Transaction confirmed”</strong>. Then, copy the transaction hash in a new text file.</p>

<p><img src="/en/assets/images/screenshot-notarization-confirmed.png" alt="screenshot-notarization-confirmed" /></p>

            </div>
            <div class="page-navigation">
                
                <a class="prev" href="/en/lessons/prepare-your-workstation/">&laquo; Prepare your workstation</a>
                
                
                <a class="next" href="/en/lessons/content-and-ownership-verification/">Content and ownership verification &raquo;</a>
                
            </div><a class="u-url" href="/en/lessons/first-notarization/" hidden></a>

        </article>
    </div>

</div>
      </div>
    </main><footer class="site-footer h-card">
    <div class="wrapper">
        <div class="footer-col-wrapper row">

            <div class="footer-col col-4">
                <i class="fas fa-code"></i> <a href="https://nemtech.github.io">Developer Center</a>
            </div>

            <div class="footer-col col-4">
                <i class="fab fa-slack"></i> <a  href="https://join.slack.com/t/nem2/shared_invite/enQtMzY4MDc2NTg0ODgyLTFhZjgxM2NhYTQ1MTY1Mjk0ZDE2ZTJlYzUxYWYxYmJlYjAyY2EwNGM5NzgxMjM4MGEzMDc5ZDIwYTgzZjgyODM">General Discussion</a>
            </div>

            <div class="footer-col col-4">
                <i class="fab fa-stack-overflow"></i><a  href="https://stackoverflow.com/tags/nem/"> Development questions</a>
            </div>
        </div>

    </div>
</footer>
<script
        src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
<script type="text/javascript" src="/en/assets/custom.js"></script></body>

</html>
